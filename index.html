<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Brain Lag Simulator ‚Äî Karndeep Baror</title>
<style>
  :root{
    --bg:#0b1020;
    --card:#0f1724;
    --accent:#8b5cf6;
    --muted:#9aa4c0;
    --glass: rgba(255,255,255,0.04);
  }
  html,body{height:100%;margin:0;font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;}
  body{
    background:
      radial-gradient(1200px 600px at 10% 10%, rgba(139,92,246,0.12), transparent 10%),
      radial-gradient(900px 500px at 90% 90%, rgba(59,130,246,0.06), transparent 15%),
      var(--bg);
    color:#e6eef8;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:32px;
    overflow:hidden;
  }

  /* Container / Card */
  .card{
    width:980px;
    max-width:98vw;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:16px;
    box-shadow: 0 10px 40px rgba(2,6,23,0.7), inset 0 1px 0 rgba(255,255,255,0.02);
    display:grid;
    grid-template-columns: 320px 1fr;
    overflow:hidden;
    transform: translateZ(0);
    border:1px solid rgba(255,255,255,0.03);
  }

  /* Left panel (menu) */
  .menu{
    padding:22px;
    background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
    border-right:1px solid rgba(255,255,255,0.02);
    display:flex;
    flex-direction:column;
    gap:12px;
  }
  .title{
    font-size:20px;
    font-weight:700;
    letter-spacing:0.4px;
    display:flex;
    gap:12px;
    align-items:center;
  }
  .logo{
    width:44px;height:44px;border-radius:10px;
    background: linear-gradient(135deg,var(--accent), #3b82f6);
    display:flex;align-items:center;justify-content:center;font-weight:800;color:white;
    box-shadow:0 6px 18px rgba(139,92,246,0.18);
    transform: rotate(-8deg);
  }
  .subtitle{font-size:12px;color:var(--muted);margin-top:4px}
  .nav{margin-top:18px;display:flex;flex-direction:column;gap:10px}
  .btn{
    padding:12px 14px;border-radius:10px;background:var(--glass);border:1px solid rgba(255,255,255,0.02);
    cursor:pointer;color:inherit;font-weight:600;display:flex;align-items:center;gap:10px;user-select:none;
    transition:transform .12s ease, box-shadow .12s ease;
  }
  .btn:hover{transform:translateY(-4px);box-shadow: 0 18px 40px rgba(2,6,23,0.6);}
  .btn.primary{
    background: linear-gradient(90deg,var(--accent),#3b82f6);
    color:white;border:none;
  }

  .small{
    font-size:13px;color:var(--muted);
  }

  /* Right panel (game area) */
  .game-wrap{padding:18px;display:flex;flex-direction:column;gap:12px;align-items:center;justify-content:flex-start;}
  .hud{width:100%;display:flex;justify-content:space-between;align-items:center;gap:12px}
  .panel{background:rgba(255,255,255,0.02);padding:8px 12px;border-radius:10px;font-size:13px;color:var(--muted);display:flex;gap:10px;align-items:center}
  .lag-meter{display:flex;gap:8px;align-items:center}
  .meter{
    width:220px;height:10px;background:rgba(255,255,255,0.03);border-radius:8px;overflow:hidden;position:relative;
  }
  .meter > i{position:absolute;left:0;top:0;bottom:0;background:linear-gradient(90deg,#f97316,#8b5cf6);width:20%;transition:width .18s linear;}

  /* Canvas container with 3D-ish effect */
  .stage{
    width:100%;max-width:100%;height:520px;border-radius:12px;overflow:hidden;display:flex;align-items:center;justify-content:center;
    perspective:1200px;
  }
  .viewport{
    width:100%;height:100%;background:
      linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01)),
      radial-gradient(400px 180px at 50% 10%, rgba(139,92,246,0.05), transparent 15%),
      rgba(6,10,20,0.6);
    border-radius:12px;padding:18px;box-sizing:border-box;
    transform-style:preserve-3d;
    box-shadow: 0 30px 60px rgba(2,6,23,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
    display:flex;flex-direction:column;
  }
  canvas{width:100%;height:100%;display:block;border-radius:8px;background:linear-gradient(180deg,#071025,#021022);}

  /* footer area */
  .controls{display:flex;gap:12px;align-items:center}
  .muted-note{font-size:12px;color:var(--muted)}

  /* About modal */
  .about{
    position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:linear-gradient(180deg, rgba(2,6,23,0.6), rgba(2,6,23,0.85));
  }
  .about .card{
    width:680px;max-width:92vw;grid-template-columns:1fr;padding:20px;
  }
  .about-content{display:flex;gap:18px;align-items:center}
  .avatar{
    width:120px;height:120px;border-radius:18px;background:linear-gradient(135deg,#f97316,#8b5cf6);display:flex;align-items:center;justify-content:center;font-size:28px;font-weight:800;
    box-shadow: 0 8px 30px rgba(139,92,246,0.18);
  }
  .about-text{color: #dfe9fb}
  .socials{display:flex;gap:10px;margin-top:10px}
  .link{
    padding:8px 12px;border-radius:10px;background:rgba(255,255,255,0.02);color:inherit;text-decoration:none;font-weight:600;border:1px solid rgba(255,255,255,0.03)
  }

  /* Responsive */
  @media (max-width:900px){
    .card{grid-template-columns:1fr;align-items:stretch}
    .menu{flex-direction:row;gap:8px;padding:12px;overflow:auto}
    .menu .nav{display:flex;flex-direction:row}
    .title{display:none}
    .game-wrap{padding:12px}
    .stage{height:420px}
  }

  /* tiny UI flourish */
  .pulse{animation: pulse 1.6s infinite ease-in-out}
  @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.02)}100%{transform:scale(1)}}
</style>
</head>
<body>
  <div class="card" role="application" aria-label="Brain Lag Simulator">

    <!-- LEFT MENU -->
    <aside class="menu" aria-hidden="false">
      <div>
        <div class="title">
          <div class="logo">BL</div>
          <div>
            Brain Lag<br><span style="font-weight:600;font-size:14px">Simulator</span>
          </div>
        </div>
        <div class="subtitle">By <strong>Karndeep Baror</strong></div>
      </div>

      <nav class="nav" aria-label="Main">
        <button class="btn primary" id="playBtn">‚ñ∂ Play</button>
        <button class="btn" id="resetBtn">‚Ü∫ Reset Score</button>
        <button class="btn" id="aboutBtn">‚ÑπÔ∏è About</button>
        <button class="btn" id="howBtn">‚ùì How to Play</button>
      </nav>

      <div style="margin-top:auto">
        <div class="small" style="margin-bottom:8px">Theme</div>
        <div style="display:flex;gap:8px">
          <button class="btn" id="vibe1">Disco</button>
          <button class="btn" id="vibe2">Classic</button>
        </div>
        <div style="margin-top:12px" class="small muted-note">Tip: controls have lag ‚Äî that's the point üòÑ</div>
      </div>
    </aside>

    <!-- RIGHT GAME AREA -->
    <section class="game-wrap" role="main">
      <div class="hud">
        <div class="panel">
          <strong>Score</strong>
          <div id="score" style="margin-left:10px;font-weight:700">0</div>
        </div>
        <div class="panel lag-meter">
          <div class="small">Brain Lag</div>
          <div class="meter" title="Lag">
            <i id="meterFill"></i>
          </div>
          <div id="lagMs" style="min-width:56px;text-align:right;font-weight:700">120 ms</div>
        </div>
      </div>

      <div class="stage">
        <div class="viewport">
          <canvas id="gameCanvas" width="960" height="480" tabindex="0" aria-label="Game canvas"></canvas>
        </div>
      </div>

      <div style="width:100%;display:flex;justify-content:space-between;align-items:center">
        <div class="controls">
          <div class="panel">
            <div style="display:flex;flex-direction:column">
              <span style="font-weight:700">Controls</span>
              <span class="small">‚Üê / ‚Üí or A / D</span>
            </div>
          </div>
          <div class="panel">
            <div style="display:flex;flex-direction:column">
              <span style="font-weight:700">Difficulty</span>
              <span id="diffLabel" class="small">Normal</span>
            </div>
          </div>
        </div>

        <div class="muted-note">Made with ‚ù§Ô∏è ‚Äî click About for creator info</div>
      </div>
    </section>
  </div>

  <!-- ABOUT MODAL -->
  <div class="about" id="aboutModal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-weight:800;font-size:18px">About</div>
        <button class="btn" id="closeAbout">Close ‚úñ</button>
      </div>
      <div style="height:14px"></div>
      <div class="about-content">
        <div class="avatar">KB</div>
        <div class="about-text">
          <div style="font-weight:800;font-size:16px">Karndeep Baror</div>
          <div class="small" style="margin-top:6px;color:#cde0ff">A tiny, stupid, intentionally laggy reflex game. Short description: <em>"A funny little game where your brain responds with a delay ‚Äî chaos guaranteed."</em></div>

          <div class="socials">
            <a class="link" href="https://instagram.com/karndeepbaror" target="_blank" rel="noopener">Instagram ‚Ä¢ @karndeepbaror</a>
            <a class="link" href="https://www.youtube.com/@CryptArea" target="_blank" rel="noopener">YouTube ‚Ä¢ @CryptArea</a>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
/*
  Brain Lag Simulator
  - Move left/right with arrow keys or A/D
  - Controls are delayed by 'lag' which increases over time
  - Avoid falling "thoughts" to keep score
  - Simple, self-contained ‚Äî no external assets
*/

(() => {
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  const scoreEl = document.getElementById('score');
  const lagMsEl = document.getElementById('lagMs');
  const meterFill = document.getElementById('meterFill');
  const diffLabel = document.getElementById('diffLabel');

  let W = canvas.width, H = canvas.height;

  // Game state
  let score = 0;
  let running = false;
  let then = performance.now();
  let spawnTimer = 0;
  let spawnInterval = 900;
  let objects = [];
  let lastTouch = 0;

  // Player
  const player = {
    x: W/2,
    y: H - 64,
    w: 56,
    h: 44,
    color: '#ffd166',
    vx: 0
  };

  // Lag mechanics
  let baseLag = 120; // ms
  let currentLag = baseLag;
  let inputBuffer = []; // stores timed commands
  const maxBuffer = 8;

  // Difficulty progression
  let timeElapsed = 0;

  // Visual vibe
  let vibe = 'disco';

  // Input handling
  const keys = { left:false, right:false };

  function pushInput(dir){
    // store {dir, time}
    inputBuffer.push({dir, t: performance.now()});
    if(inputBuffer.length > maxBuffer) inputBuffer.shift();
  }

  // Process buffered input after currentLag
  function processBuffer(){
    const now = performance.now();
    while(inputBuffer.length){
      const item = inputBuffer[0];
      if(now - item.t >= currentLag){
        // apply
        if(item.dir === 'left') player.vx = -6;
        else if(item.dir === 'right') player.vx = 6;
        else player.vx = 0;
        inputBuffer.shift();
      } else break;
    }
  }

  // keyboard
  window.addEventListener('keydown', (e) => {
    if(e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') {
      pushInput('left'); e.preventDefault();
    }
    if(e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') {
      pushInput('right'); e.preventDefault();
    }
  });
  window.addEventListener('keyup', (e) => {
    if(e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') {
      pushInput('none'); e.preventDefault();
    }
    if(e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') {
      pushInput('none'); e.preventDefault();
    }
  });

  // Buttons
  document.getElementById('playBtn').addEventListener('click', startGame);
  document.getElementById('resetBtn').addEventListener('click', resetScore);
  document.getElementById('aboutBtn').addEventListener('click', openAbout);
  document.getElementById('closeAbout').addEventListener('click', closeAbout);
  document.getElementById('howBtn').addEventListener('click', showHow);
  document.getElementById('vibe1').addEventListener('click', ()=>{vibe='disco'});
  document.getElementById('vibe2').addEventListener('click', ()=>{vibe='classic'});

  // About modal functions
  const aboutModal = document.getElementById('aboutModal');
  function openAbout(){
    aboutModal.style.display = 'flex';
    aboutModal.setAttribute('aria-hidden', 'false');
  }
  function closeAbout(){
    aboutModal.style.display = 'none';
    aboutModal.setAttribute('aria-hidden', 'true');
  }
  function showHow(){
    alert('Move with ‚Üê / ‚Üí or A / D. Controls respond after a "brain lag" ‚Äî intentionally delayed. Avoid falling thoughts. Score increases over time.');
  }

  function resetScore(){
    score = 0;
    updateScore();
  }

  function updateScore(){
    scoreEl.textContent = Math.floor(score);
  }

  // Spawning falling objects (thoughts)
  function spawnThought(){
    const size = 18 + Math.random()*36;
    const x = 30 + Math.random()*(W-60);
    const speed = 1.2 + Math.random()*3 + Math.min(timeElapsed/30, 4);
    const rot = (Math.random()-0.5)*0.6;
    objects.push({x, y:-size, r:size, speed, rot, hue: Math.random()*360});
  }

  // collision
  function collide(pl, obj){
    const dx = Math.abs((pl.x) - obj.x);
    const dy = Math.abs((pl.y) - obj.y);
    if (dx < pl.w/2 + obj.r && dy < pl.h/2 + obj.r) return true;
    return false;
  }

  // Resize handling
  function resize(){
    const ratio = canvas.width / canvas.clientWidth;
    W = canvas.width = Math.max(600, Math.min(1200, canvas.clientWidth*1));
    H = canvas.height = Math.max(320, Math.min(720, canvas.clientHeight*1));
  }
  window.addEventListener('resize', resize);

  // draw brain (player) with 3D-ish shading and trailing ghosts
  function drawPlayer(ctx, px, py, t){
    // shadow
    ctx.save();
    ctx.translate(px, py);
    const gradient = ctx.createLinearGradient(-30,-20,30,40);
    gradient.addColorStop(0,'#ffd166');
    gradient.addColorStop(1,'#ff8a65');
    ctx.fillStyle = gradient;
    ctx.beginPath();
    ctx.ellipse(0, 0, player.w/2+4, player.h/2+8, Math.sin(t/400)*0.08, 0, Math.PI*2);
    ctx.fill();

    // inner brain lobes - wavy circles
    for(let i=0;i<4;i++){
      ctx.save();
      const s = 0.85 - i*0.12;
      ctx.globalAlpha = 0.7 - i*0.13;
      ctx.fillStyle = `hsla(${220 + i*18}, 80%, ${60 - i*6}%, 0.95)`;
      ctx.beginPath();
      ctx.ellipse(-8 + Math.sin(t/300 + i)*6*i*0.2, -4 + Math.cos(t/350 + i)*6*i*0.2, (player.w/2-6)*s, (player.h/2-10)*s, Math.sin(t/250 + i)*0.06, 0, Math.PI*2);
      ctx.fill();
      ctx.restore();
    }

    // face (for meme)
    ctx.fillStyle = '#1b2430';
    ctx.beginPath(); ctx.arc(-8, -6, 4, 0, Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(8, -6, 4, 0, Math.PI*2); ctx.fill();
    ctx.fillStyle = '#fff';
    ctx.beginPath(); ctx.arc(-7.2, -5.6, 1.4, 0, Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(7.8, -5.6, 1.4, 0, Math.PI*2); ctx.fill();

    ctx.restore();
  }

  // draw falling thought
  function drawThought(ctx, o, t){
    ctx.save();
    ctx.translate(o.x, o.y);
    ctx.rotate(Math.sin(t/700 + o.r)*o.rot);
    // blob
    const g = ctx.createRadialGradient(0,0,o.r*0.1,0,0,o.r);
    g.addColorStop(0, `hsla(${o.hue}, 80%, 60%, 0.98)`);
    g.addColorStop(1, `hsla(${o.hue+40}, 80%, 45%, 0.95)`);
    ctx.fillStyle = g;
    ctx.beginPath();
    ctx.ellipse(0, 0, o.r, o.r*0.75, Math.sin(t/300 + o.r)*0.15, 0, Math.PI*2);
    ctx.fill();

    // little sparkles
    ctx.fillStyle = 'rgba(255,255,255,0.7)';
    ctx.beginPath(); ctx.arc(-o.r*0.2, -o.r*0.1, Math.max(1, o.r*0.08), 0, Math.PI*2); ctx.fill();
    ctx.restore();
  }

  // scoreboard / meter update
  function updateHUD(){
    lagMsEl.textContent = Math.round(currentLag) + ' ms';
    const pct = Math.min(100, (currentLag - baseLag) / 6 + 20);
    meterFill.style.width = Math.max(6, pct) + '%';
    diffLabel.textContent = currentLag > 420 ? 'Insane' : currentLag > 280 ? 'Hard' : 'Normal';
  }

  // Main loop
  function loop(now){
    const dt = now - then;
    then = now;
    if(!running) { drawIdle(now); return; }

    // increase difficulty slowly
    timeElapsed += dt/1000;
    currentLag = baseLag + Math.min(700, timeElapsed*18 + Math.sin(now/1200)*18); // lag grows slowly

    // spawn
    spawnTimer += dt;
    if(spawnTimer > spawnInterval){
      spawnTimer = 0;
      spawnInterval = Math.max(420, 900 - timeElapsed*8);
      spawnThought();
    }

    // process buffered input
    processBuffer();

    // friction & apply movement
    player.x += player.vx;
    player.vx *= 0.86; // friction

    // keep inside
    player.x = Math.max(28, Math.min(W-28, player.x));

    // update objects
    for(let i=objects.length-1;i>=0;i--){
      const o = objects[i];
      o.y += o.speed;
      o.rot *= 0.995;
      // off screen
      if(o.y - o.r > H + 40){ objects.splice(i,1); score += 1; updateScore(); continue; }
      // collision
      if(collide(player, o)){
        // crash!
        running = false;
        // small shake and final score
        shakeScreen(14);
        showGameOver();
        break;
      }
    }

    // draw
    drawScene(now);
    updateHUD();

    requestAnimationFrame(loop);
  }

  // Idle background draw
  function drawIdle(t){
    ctx.clearRect(0,0,W,H);
    // soft grid
    const gStep = 48;
    ctx.save();
    ctx.globalAlpha = 0.06;
    ctx.strokeStyle = '#ffffff';
    for(let x=0;x<W;x+=gStep){
      ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,H); ctx.stroke();
    }
    for(let y=0;y<H;y+=gStep){
      ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(W,y); ctx.stroke();
    }
    ctx.restore();

    // center brain
    drawPlayer(ctx, W/2, H/2, t);
    // message
    ctx.fillStyle = 'rgba(255,255,255,0.9)';
    ctx.font = '600 18px Inter, system-ui, Arial';
    ctx.textAlign = 'center';
    ctx.fillText('Brain Lag Simulator', W/2, H*0.18);
    ctx.font = '13px Inter, system-ui';
    ctx.fillStyle = 'rgba(200,220,255,0.6)';
    ctx.fillText('Press Play to start ‚Äî controls respond with a delay (that\'s the fun!)', W/2, H*0.22);
    requestAnimationFrame(drawIdle);
  }

  function drawScene(now){
    ctx.clearRect(0,0,W,H);

    // parallax background (3D-ish)
    const t = now;
    const cx = Math.sin(t/2700)*60;
    const cy = Math.cos(t/2000)*20;
    const grd = ctx.createLinearGradient(0, cy, 0, H + cy);
    grd.addColorStop(0, '#081421');
    grd.addColorStop(1, '#021022');
    ctx.fillStyle = grd;
    ctx.fillRect(0,0,W,H);

    // subtle floating shapes
    ctx.save();
    ctx.globalAlpha = 0.06;
    ctx.fillStyle = '#ffffff';
    for(let i=0;i<6;i++){
      const sx = (i*200 + (t/6)%600) % (W+200) - 100;
      ctx.beginPath();
      ctx.ellipse(sx + Math.sin(t/1000+i)*40, 60 + Math.cos(t/900+i)*24, 120 - i*12, 40 - i*4, Math.sin(t/2000+i)*0.2, 0, Math.PI*2);
      ctx.fill();
    }
    ctx.restore();

    // draw objects
    for(const o of objects) drawThought(ctx, o, t);

    // glow under player (3D)
    const glow = ctx.createRadialGradient(player.x, player.y+18, 8, player.x, player.y+18, 80);
    glow.addColorStop(0, 'rgba(139,92,246,0.17)');
    glow.addColorStop(1, 'rgba(7,16,36,0)');
    ctx.fillStyle = glow;
    ctx.beginPath(); ctx.ellipse(player.x, player.y+20, 80, 24, 0, 0, Math.PI*2); ctx.fill();

    // player trails to emphasize lag (ghosts)
    for(let i=0;i<6;i++){
      const a = 1 - i*0.12;
      const ox = player.x - player.vx * (i*3 + 1);
      ctx.globalAlpha = a*0.6;
      drawPlayer(ctx, ox, player.y, t - i*80);
    }
    ctx.globalAlpha = 1;
  }

  // small screen shake on fail
  function shakeScreen(intensity=8){
    const root = document.querySelector('.card');
    root.animate([
      { transform: 'translateX(0px)' },
      { transform: `translateX(${intensity}px)` },
      { transform: `translateX(${-intensity}px)` },
    
